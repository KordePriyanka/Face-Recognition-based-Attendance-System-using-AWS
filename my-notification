import boto3 
 
topic_arn = "arn:aws:sns:ap-south-1:413313710573:my-notification" 
def send_sns(message, subject): 
    try: 
        client = boto3.client("sns") 
        result = client.publish(TopicArn=topic_arn, Message=message, Subject=subject) 
        if result['ResponseMetadata']['HTTPStatusCode'] == 200: 
            print(result) 
            print("Notification send successfully..!!!") 
            return True 
    except Exception as e: 
        print("Error occured while publish notifications and error is : ", e) 
        return True 
 
def lambda_handler(event, context): 
    print("event collected is {}".format(event)) 
    for record in event['Records'] : 
        s3_bucket = record['s3']['bucket']['name'] 
        print("Bucket name is {}".format(s3_bucket)) 
        s3_key = record['s3']['object']['key'] 
        print("Bucket key name is {}".format(s3_key)) 
        message = "The Attendence has been marled Successfully...!" 
        subject = "Attendence update" 
        SNSResult = send_sns(message, subject) 
        if SNSResult : 
            print("Notification Sent..")  
            return SNSResult 
        else: 
            return False